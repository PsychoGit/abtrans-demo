// Embedded translations to avoid fetch issues
const translationsData = {
    "en": {
        "nav": {
            "home": "Home",
            "about": "About Us",
            "services": "Services",
            "location": "Location",
            "contact": "Contact"
        },
        "hero": {
            "title": "Reliable Transportation",
            "subtitle": "For Your Business",
            "description": "Professional trucking services with a commitment to excellence and on-time delivery",
            "cta": "Get In Touch"
        },
        "about": {
            "title": "About AB Transport",
            "paragraph1": "With years of experience in the transportation industry, AB Transport has built a reputation for reliability, safety, and exceptional service. Our small fleet allows us to provide personalized attention to every shipment.",
            "paragraph2": "We specialize in regional and local transportation, ensuring your goods reach their destination safely and on schedule. Our team of professional drivers is dedicated to maintaining the highest standards of service.",
            "years": "Years Experience",
            "fleet": "Vehicle Fleet",
            "delivery": "On-Time Delivery"
        },
        "services": {
            "title": "Our Services",
            "freight": {
                "title": "Freight Transportation",
                "description": "Reliable freight transportation services for businesses of all sizes. We handle your cargo with care and deliver on time."
            },
            "local": {
                "title": "Local Delivery",
                "description": "Fast and efficient local delivery services within the region. Perfect for time-sensitive shipments."
            },
            "warehouse": {
                "title": "Warehouse Logistics",
                "description": "Comprehensive warehouse and logistics solutions to streamline your supply chain operations."
            },
            "insured": {
                "title": "Insured Shipments",
                "description": "All shipments are fully insured for your peace of mind. Your cargo is protected throughout transit."
            }
        },
        "location": {
            "title": "Our Location",
            "subtitle": "Visit Our Headquarters",
            "address": "Address:",
            "addressText": "KUKULJANOVO, Kukuljanovo 176",
            "hours": "Operating Hours:",
            "hoursText": "Monday - Friday: 6:00 - 20:00 <br>Saturday: 7:00 AM - 3:00 PM<br>Sunday: Closed",
            "serviceArea": "Service Area:",
            "serviceAreaText": "Poslujemo na području Hrvatske i okolnom regijom."
        },
        "contact": {
            "title": "Contact Us",
            "subtitle": "Get In Touch",
            "phone": "Phone:",
            "email": "Email:",
            "emergency": "Emergency Contact:",
            "form": {
                "name": "Full Name",
                "email": "Email Address",
                "phone": "Phone Number",
                "subject": "Subject",
                "message": "Message",
                "submit": "Send Message"
            },
            "success": "Thank you for your message! We'll get back to you soon.",
            "validation": {
                "required": "Please fill in all required fields.",
                "email": "Please enter a valid email address."
            }
        },
        "footer": {
            "company": "AB Transport",
            "description": "Your trusted partner in transportation and logistics services.",
            "quickLinks": "Quick Links",
            "contactInfo": "Contact Info",
            "copyright": "© {year} AB Transport. All rights reserved."
        }
    },
    "hr": {
        "nav": {
            "home": "Početna",
            "about": "O Nama",
            "services": "Usluge",
            "location": "Lokacija",
            "contact": "Kontakt"
        },
        "hero": {
            "title": "Pouzdan Prijevoz",
            "subtitle": "Za Vaš Posao",
            "description": "Profesionalne usluge prijevoza s posvećenošću izvrsnosti i isporuci na vrijeme",
            "cta": "Kontaktirajte Nas"
        },
        "about": {
            "title": "O AB Transport",
            "paragraph1": "S godinama iskustva u prijevozništvu, AB Transport je izgradio reputaciju pouzdanosti, sigurnosti i izvanredne usluge. Naša mala flota omogućuje nam da pružamo personaliziranu pažnju svakoj pošiljci.",
            "paragraph2": "Specijalizirani smo za regionalni i lokalni prijevoz, osiguravajući da vaša roba stigne na odredište sigurno i u planiranom vremenu. Naš tim profesionalnih vozača posvećen je održavanju najviših standarda usluge.",
            "years": "Godine Iskustva",
            "fleet": "Vozni Park",
            "delivery": "Isporuka na Vrijeme"
        },
        "services": {
            "title": "Naše Usluge",
            "freight": {
                "title": "Prijevoz Tereta",
                "description": "Pouzdane usluge prijevoza tereta za tvrtke svih veličina. S vašim teretom postupamo pažljivo i dostavljamo ga na vrijeme."
            },
            "local": {
                "title": "Lokalna Dostava",
                "description": "Brze i učinkovite usluge lokalne dostave unutar regije. Savršeno za pošiljke osjetljive na vrijeme."
            },
            "warehouse": {
                "title": "Skladišna Logistika",
                "description": "Sveobuhvatna skladišna i logistička rješenja za poboljšanje vaših operacija opskrbnog lanca."
            },
            "insured": {
                "title": "Osigurane Pošiljke",
                "description": "Sve pošiljke su u potpunosti osigurane za vaš mir. Vaš teret je zaštićen tijekom cijelog prijevoza."
            }
        },
        "location": {
            "title": "Naša Lokacija",
            "subtitle": "Posjetite Naše Sjedište",
            "address": "Adresa:",
            "addressText": "KUKULJANOVO, Kukuljanovo 176",
            "hours": "Radno Vrijeme:",
            "hoursText": "Ponedjeljak - Petak: 6:00 - 20:00<br>Subota: 7:00 - 15:00<br>Nedjelja: Zatvoreno",
            "serviceArea": "Područje Usluge:",
            "serviceAreaText": "Poslujemo na području Hrvatske i okolnom regijom."
        },
        "contact": {
            "title": "Kontaktirajte Nas",
            "subtitle": "Kontaktirajte Nas",
            "phone": "Telefon:",
            "email": "Email:",
            "emergency": "Hitni Kontakt:",
            "form": {
                "name": "Ime i Prezime",
                "email": "Email Adresa",
                "phone": "Broj Telefona",
                "subject": "Predmet",
                "message": "Poruka",
                "submit": "Pošalji Poruku"
            },
            "success": "Hvala na vašoj poruci! Javit ćemo vam se uskoro.",
            "validation": {
                "required": "Molimo popunite sva obavezna polja.",
                "email": "Molimo unesite valjanu email adresu."
            }
        },
        "footer": {
            "company": "AB Transport",
            "description": "Vaš pouzdani partner u prijevozu i logističkim uslugama.",
            "quickLinks": "Brze Poveznice",
            "contactInfo": "Kontakt Informacije",
            "copyright": "© {year} AB Transport. Sva prava pridržana."
        }
    },
    "it": {
        "nav": {
            "home": "Home",
            "about": "Chi Siamo",
            "services": "Servizi",
            "location": "Posizione",
            "contact": "Contatto"
        },
        "hero": {
            "title": "Trasporti Affidabili",
            "subtitle": "Per la Tua Azienda",
            "description": "Servizi di trasporto professionali con un impegno per l'eccellenza e la consegna puntuale",
            "cta": "Contattaci"
        },
        "about": {
            "title": "Chi Siamo AB Transport",
            "paragraph1": "Con anni di esperienza nel settore dei trasporti, AB Transport ha costruito una reputazione di affidabilità, sicurezza e servizio eccezionale. La nostra piccola flotta ci permette di fornire attenzione personalizzata a ogni spedizione.",
            "paragraph2": "Ci specializziamo in trasporti regionali e locali, garantendo che le vostre merci raggiungano la destinazione in sicurezza e secondo programma. Il nostro team di autori professionisti è dedicato a mantenere i più alti standard di servizio.",
            "years": "Anni di Esperienza",
            "fleet": "Parco Veicoli",
            "delivery": "Consegna Puntuale"
        },
        "services": {
            "title": "I Nostri Servizi",
            "freight": {
                "title": "Trasporto Merci",
                "description": "Servizi di trasporto merci affidabili per aziende di tutte le dimensioni. Gestiamo il vostro carico con cura e consegniamo puntualmente."
            },
            "local": {
                "title": "Consegna Locale",
                "description": "Servizi di consegna locale veloci ed efficienti nella regione. Perfetto per spedizioni sensibili al tempo."
            },
            "warehouse": {
                "title": "Logistica Magazzino",
                "description": "Soluzioni complete di magazzino e logistica per ottimizzare le operazioni della vostra catena di approvvigionamento."
            },
            "insured": {
                "title": "Spedizioni Assicurate",
                "description": "Tutte le spedizioni sono completamente assicurate per la vostra tranquillità. Il vostro carico è protetto durante tutto il trasporto."
            }
        },
        "location": {
            "title": "La Nostra Posizione",
            "subtitle": "Visita la Nostra Sede",
            "address": "Indirizzo:",
            "addressText": "KUKULJANOVO, Kukuljanovo 176",
            "hours": "Orari di Apertura:",
            "hoursText": "Lunedì - Venerdì: 6:00 - 20:00<br>Sabato: 7:00 - 15:00<br>Domenica: Chiuso",
            "serviceArea": "Area di Servizio:",
            "serviceAreaText": "Poslujemo na području Hrvatske i okolnom regijom."
        },
        "contact": {
            "title": "Contattaci",
            "subtitle": "Contattaci",
            "phone": "Telefono:",
            "email": "Email:",
            "emergency": "Contatto di Emergenza:",
            "form": {
                "name": "Nome Completo",
                "email": "Indirizzo Email",
                "phone": "Numero di Telefono",
                "subject": "Oggetto",
                "message": "Messaggio",
                "submit": "Invia Messaggio"
            },
            "success": "Grazie per il tuo messaggio! Ti ricontatteremo presto.",
            "validation": {
                "required": "Per favore compila tutti i campi obbligatori.",
                "email": "Per favore inserisci un indirizzo email valido."
            }
        },
        "footer": {
            "company": "AB Transport",
            "description": "Il tuo partner affidabile nei servizi di trasporto e logistica.",
            "quickLinks": "Link Rapidi",
            "contactInfo": "Info Contatto",
            "copyright": "© {year} AB Transport. Tutti i diritti riservati."
        }
    },
    "de": {
        "nav": {
            "home": "Startseite",
            "about": "Über Uns",
            "services": "Dienstleistungen",
            "location": "Standort",
            "contact": "Kontakt"
        },
        "hero": {
            "title": "Zuverlässiger Transport",
            "subtitle": "Für Ihr Unternehmen",
            "description": "Professionelle Transportdienstleistungen mit Engagement für Exzellenz und pünktliche Lieferung",
            "cta": "Kontaktieren Sie Uns"
        },
        "about": {
            "title": "Über AB Transport",
            "paragraph1": "Mit Jahren Erfahrung in der Transportbranche hat AB Transport einen Ruf für Zuverlässigkeit, Sicherheit und herausragenden Service aufgebaut. Unsere kleine Flotte ermöglicht es uns, jede Sendung persönliche Aufmerksamkeit zu widmen.",
            "paragraph2": "Wir spezialisieren uns auf regionalen und lokalen Transport und stellen sicher, dass Ihre Waren sicher und planmäßig ihr Ziel erreichen. Unser Team professioneller Fahrer ist der Aufrechterhaltung höchster Service-Standards verpflichtet.",
            "years": "Jahre Erfahrung",
            "fleet": "Fuhrpark",
            "delivery": "Pünktliche Lieferung"
        },
        "services": {
            "title": "Unsere Dienstleistungen",
            "freight": {
                "title": "Frachttransport",
                "description": "Zuverlässige Frachttransportdienstleistungen für Unternehmen jeder Größe. Wir behandeln Ihre Fracht mit Sorgfalt und liefern pünktlich."
            },
            "local": {
                "title": "Lokale Lieferung",
                "description": "Schnelle und effiziente lokale Lieferdienste in der Region. Perfekt für zeitkritische Sendungen."
            },
            "warehouse": {
                "title": "Lagerlogistik",
                "description": "Umfassende Lager- und Logistiklösungen zur Optimierung Ihrer Lieferkettenoperationen."
            },
            "insured": {
                "title": "Versicherte Sendungen",
                "description": "Alle Sendungen sind vollständig versichert für Ihre peace of mind. Ihre Fracht ist während des gesamten Transports geschützt."
            }
        },
        "location": {
            "title": "Unser Standort",
            "subtitle": "Besuchen Sie Unsere Zentrale",
            "address": "Adresse:",
            "addressText": "KUKULJANOVO, Kukuljanovo 176",
            "hours": "Öffnungszeiten:",
            "hoursText": "Montag - Freitag: 6:00 - 20:00 Uhr<br>Samstag: 7:00 - 15:00 Uhr<br>Sonntag: Geschlossen",
            "serviceArea": "Servicegebiet:",
            "serviceAreaText": "Poslujemo na području Hrvatske i okolnom regijom."
        },
        "contact": {
            "title": "Kontaktieren Sie Uns",
            "subtitle": "Kontaktieren Sie Uns",
            "phone": "Telefon:",
            "email": "Email:",
            "emergency": "Notfallkontakt:",
            "form": {
                "name": "Vollständiger Name",
                "email": "E-Mail-Adresse",
                "phone": "Telefonnummer",
                "subject": "Betreff",
                "message": "Nachricht",
                "submit": "Nachricht Senden"
            },
            "success": "Vielen Dank für Ihre Nachricht! Wir werden uns bald bei Ihnen melden.",
            "validation": {
                "required": "Bitte füllen Sie alle erforderlichen Felder aus.",
                "email": "Bitte geben Sie eine gültige E-Mail-Adresse ein."
            }
        },
        "footer": {
            "company": "AB Transport",
            "description": "Ihr vertrauenswürdiger Partner in Transport- und Logistikdienstleistungen.",
            "quickLinks": "Schnelllinks",
            "contactInfo": "Kontaktinformationen",
            "copyright": "© {year} AB Transport. Alle Rechte vorbehalten."
        }
    }
};

// Language Management System
class LanguageManager {
    constructor() {
        this.currentLang = localStorage.getItem('selectedLanguage') || 'en';
        this.translations = translationsData;
        this.init();
    }

    init() {
        // Set up language selector
        this.setupLanguageSelector();
        
        // Apply initial language
        this.applyLanguage(this.currentLang);
        
        // Update document language
        document.documentElement.lang = this.currentLang;
    }

    setupLanguageSelector() {
        const selector = document.getElementById('languageSelect');
        if (selector) {
            selector.value = this.currentLang;
            selector.addEventListener('change', (e) => {
                this.switchLanguage(e.target.value);
            });
        }
    }

    switchLanguage(lang) {
        this.currentLang = lang;
        localStorage.setItem('selectedLanguage', lang);
        this.applyLanguage(lang);
        document.documentElement.lang = lang;
        
        // Update typing animation for hero title
        this.restartTypingAnimation();
    }

    applyLanguage(lang) {
        const elements = document.querySelectorAll('[data-translate]');
        elements.forEach(element => {
            const key = element.getAttribute('data-translate');
            const translation = this.getTranslation(key, lang);
            if (translation) {
                if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    element.placeholder = translation;
                } else {
                    // Handle HTML content in translations (like <br> tags)
                    if (translation.includes('<')) {
                        element.innerHTML = translation;
                    } else {
                        element.textContent = translation;
                    }
                }
            }
        });

        // Update form placeholders
        this.updateFormPlaceholders(lang);
        
        // Update copyright year
        this.updateCopyrightYear();
    }

    getTranslation(key, lang) {
        const keys = key.split('.');
        let value = this.translations[lang];
        
        for (const k of keys) {
            if (value && value[k] !== undefined) {
                value = value[k];
            } else {
                console.warn(`Translation not found for key: ${key} in language: ${lang}`);
                return null;
            }
        }
        
        return value;
    }

    restartTypingAnimation() {
        const typingElement = document.querySelector('.typing-text');
        if (typingElement) {
            // Remove animation
            typingElement.classList.remove('typing-animation');
            
            // Force reflow
            typingElement.offsetHeight;
            
            // Get current text
            const currentText = this.getTranslation('hero.title', this.currentLang) || 'Reliable Transportation';
            typingElement.textContent = '';
            
            // Start smooth typing animation
            this.typeText(typingElement, currentText, 100);
        }
    }

    typeText(element, text, speed = 100) {
        let i = 0;
        element.classList.add('typing-animation');
        
        function type() {
            if (i < text.length) {
                element.textContent += text.charAt(i);
                i++;
                setTimeout(type, speed);
            } else {
                // Add cursor blink after typing is complete
                element.style.borderRight = '3px solid white';
                element.style.animation = 'blink 1s infinite';
            }
        }
        
        // Clear any existing content and start typing
        element.textContent = '';
        element.style.borderRight = 'none';
        element.style.animation = 'none';
        type();
    }

    updateFormPlaceholders(lang) {
        const formInputs = document.querySelectorAll('input[placeholder], textarea[placeholder]');
        formInputs.forEach(input => {
            const translateKey = input.getAttribute('data-translate');
            if (translateKey) {
                const translation = this.getTranslation(translateKey, lang);
                if (translation) {
                    input.placeholder = translation;
                }
            }
        });
    }

    updateCopyrightYear() {
        const copyrightElement = document.querySelector('[data-translate="footer.copyright"]');
        if (copyrightElement) {
            const currentYear = new Date().getFullYear();
            const translation = this.getTranslation('footer.copyright', this.currentLang);
            if (translation) {
                copyrightElement.textContent = translation.replace('{year}', currentYear);
            }
        }
    }
}

// Initialize Language Manager
const languageManager = new LanguageManager();

// Mobile Navigation Toggle
const hamburger = document.querySelector('.hamburger');
const navMenu = document.querySelector('.nav-menu');

hamburger.addEventListener('click', () => {
    hamburger.classList.toggle('active');
    navMenu.classList.toggle('active');
});

// Close mobile menu when clicking on a link
document.querySelectorAll('.nav-menu a').forEach(link => {
    link.addEventListener('click', () => {
        hamburger.classList.remove('active');
        navMenu.classList.remove('active');
    });
});

// Header scroll effect
window.addEventListener('scroll', () => {
    const header = document.querySelector('.header');
    if (window.scrollY > 100) {
        header.style.background = 'rgba(255, 255, 255, 0.98)';
        header.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.1)';
    } else {
        header.style.background = 'rgba(255, 255, 255, 0.95)';
        header.style.boxShadow = 'var(--shadow)';
    }
});

// Smooth scrolling for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            const headerOffset = 70;
            const elementPosition = target.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        }
    });
});

// Contact Form Handling
const contactForm = document.getElementById('contactForm');
const successMessage = document.createElement('div');
successMessage.className = 'success-message';
contactForm.parentNode.insertBefore(successMessage, contactForm);

contactForm.addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Get form data
    const formData = new FormData(this);
    const name = formData.get('name');
    const email = formData.get('email');
    const phone = formData.get('phone');
    const subject = formData.get('subject');
    const message = formData.get('message');
    
    // Basic validation
    if (!name || !email || !subject || !message) {
        alert(languageManager.getTranslation('contact.validation.required', languageManager.currentLang) || 'Please fill in all required fields.');
        return;
    }
    
    // Email validation
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        alert(languageManager.getTranslation('contact.validation.email', languageManager.currentLang) || 'Please enter a valid email address.');
        return;
    }
    
    // Simulate form submission (in real implementation, this would be an API call)
    const submitButton = this.querySelector('.submit-button');
    const originalText = submitButton.textContent;
    
    submitButton.textContent = 'Sending...';
    submitButton.disabled = true;
    
    setTimeout(() => {
        // Show success message
        const successText = languageManager.getTranslation('contact.success', languageManager.currentLang) || 'Thank you for your message! We\'ll get back to you soon.';
        successMessage.textContent = successText;
        successMessage.classList.add('show');
        
        // Reset form
        this.reset();
        
        // Reset button
        submitButton.textContent = originalText;
        submitButton.disabled = false;
        
        // Hide success message after 5 seconds
        setTimeout(() => {
            successMessage.classList.remove('show');
        }, 5000);
        
        // Log form data (in real implementation, this would be sent to a server)
        console.log('Form submitted with data:', {
            name,
            email,
            phone,
            subject,
            message,
            language: languageManager.currentLang
        });
    }, 1500);
});

// Intersection Observer for fade-in animations
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver(function(entries) {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('visible');
        }
    });
}, observerOptions);

// Add fade-in class to elements and observe them
document.addEventListener('DOMContentLoaded', function() {
    const animatedElements = document.querySelectorAll('.service-card, .stat, .about-text, .location-info, .contact-info, .contact-form');
    
    animatedElements.forEach(el => {
        el.classList.add('fade-in');
        observer.observe(el);
    });
});

// Parallax effect for hero section
window.addEventListener('scroll', () => {
    const scrolled = window.pageYOffset;
    const parallax = document.querySelector('.hero');
    const speed = scrolled * 0.5;
    
    if (parallax) {
        parallax.style.transform = `translateY(${speed}px)`;
    }
});

// Active navigation highlighting
const sections = document.querySelectorAll('section[id]');
const navLinks = document.querySelectorAll('.nav-menu a');

window.addEventListener('scroll', () => {
    let current = '';
    
    sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (pageYOffset >= sectionTop - 200) {
            current = section.getAttribute('id');
        }
    });
    
    navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href').slice(1) === current) {
            link.classList.add('active');
        }
    });
});

// Add loading animation to images
document.querySelectorAll('img').forEach(img => {
    img.addEventListener('load', function() {
        this.style.opacity = '0';
        this.style.transition = 'opacity 0.5s ease-in-out';
        setTimeout(() => {
            this.style.opacity = '1';
        }, 100);
    });
});

// Counter animation for stats
function animateCounter(element, target, duration = 2000) {
    let start = 0;
    const increment = target / (duration / 16);
    
    function updateCounter() {
        start += increment;
        if (start < target) {
            element.textContent = Math.floor(start);
            requestAnimationFrame(updateCounter);
        } else {
            element.textContent = target;
        }
    }
    
    updateCounter();
}

// Trigger counter animation when stats section is visible
const statsSection = document.querySelector('.stats');
const statsObserver = new IntersectionObserver(function(entries) {
    entries.forEach(entry => {
        if (entry.isIntersecting && !entry.target.classList.contains('animated')) {
            entry.target.classList.add('animated');
            const statNumbers = entry.target.querySelectorAll('h3');
            
            statNumbers.forEach(stat => {
                const text = stat.textContent;
                // Handle special cases like "10+" or "98%"
                if (text.includes('+')) {
                    const number = parseInt(text);
                    if (!isNaN(number)) {
                        animateCounter(stat, number);
                        setTimeout(() => {
                            stat.textContent = text;
                        }, 2000);
                    }
                } else if (text.includes('%')) {
                    const number = parseInt(text);
                    if (!isNaN(number)) {
                        animateCounter(stat, number);
                        setTimeout(() => {
                            stat.textContent = text;
                        }, 2000);
                    }
                } else {
                    const number = parseInt(text);
                    if (!isNaN(number)) {
                        animateCounter(stat, number);
                    }
                }
            });
        }
    });
}, { threshold: 0.5 });

if (statsSection) {
    statsObserver.observe(statsSection);
}

// Add ripple effect to buttons
document.querySelectorAll('.cta-button, .submit-button, .social-link').forEach(button => {
    button.addEventListener('click', function(e) {
        const ripple = document.createElement('span');
        const rect = this.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        const x = e.clientX - rect.left - size / 2;
        const y = e.clientY - rect.top - size / 2;
        
        ripple.style.width = ripple.style.height = size + 'px';
        ripple.style.left = x + 'px';
        ripple.style.top = y + 'px';
        ripple.classList.add('ripple');
        
        this.appendChild(ripple);
        
        setTimeout(() => {
            ripple.remove();
        }, 600);
    });
});

// Add CSS for ripple effect
const style = document.createElement('style');
style.textContent = `
    .cta-button, .submit-button, .social-link {
        position: relative;
        overflow: hidden;
    }
    
    .ripple {
        position: absolute;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.5);
        transform: scale(0);
        animation: ripple-animation 0.6s ease-out;
        pointer-events: none;
    }
    
    @keyframes ripple-animation {
        to {
            transform: scale(4);
            opacity: 0;
        }
    }
`;
document.head.appendChild(style);

// Enhanced truck animation with random speeds
const truck = document.querySelector('.truck');
if (truck) {
    function randomizeTruckSpeed() {
        const baseSpeed = 8; // seconds
        const variation = 4; // seconds variation
        const randomSpeed = baseSpeed + Math.random() * variation;
        truck.style.animationDuration = randomSpeed + 's';
    }
    
    randomizeTruckSpeed();
    setInterval(randomizeTruckSpeed, 20000); // Change speed every 20 seconds
}

// Add keyboard navigation support
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        // Close mobile menu if open
        hamburger.classList.remove('active');
        navMenu.classList.remove('active');
    }
});

// Performance optimization: Debounce scroll events
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Apply debounce to scroll event listeners
const debouncedScrollHandler = debounce(() => {
    const header = document.querySelector('.header');
    if (window.scrollY > 100) {
        header.style.background = 'rgba(255, 255, 255, 0.98)';
        header.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.1)';
    } else {
        header.style.background = 'rgba(255, 255, 255, 0.95)';
        header.style.boxShadow = 'var(--shadow)';
    }
    
    // Update active navigation
    let current = '';
    sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (pageYOffset >= sectionTop - 200) {
            current = section.getAttribute('id');
        }
    });
    
    navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href').slice(1) === current) {
            link.classList.add('active');
        }
    });
}, 10);

window.addEventListener('scroll', debouncedScrollHandler);

// Export language manager for global access (if needed)
window.languageManager = languageManager;

// Custom Language Selector with Flag Images
document.addEventListener('DOMContentLoaded', function() {
    const customSelects = document.querySelectorAll('.custom-select');
    
    customSelects.forEach(customSelect => {
        const selectSelected = customSelect.querySelector('.select-selected');
        const selectItems = customSelect.querySelector('.select-items');
        const selectItemElements = customSelect.querySelectorAll('.select-item');
        
        // Toggle dropdown
        selectSelected.addEventListener('click', function(e) {
            e.stopPropagation();
            closeAllSelects(this);
            selectItems.classList.toggle('select-hide');
        });
        
        // Handle item selection
        selectItemElements.forEach(item => {
            item.addEventListener('click', function(e) {
                e.stopPropagation();
                
                const value = this.getAttribute('data-value');
                const flagSrc = this.querySelector('.flag-icon').src;
                const text = this.querySelector('span').textContent;
                
                // Update selected display
                selectSelected.querySelector('.flag-icon').src = flagSrc;
                selectSelected.querySelector('span').textContent = text;
                
                // Close dropdown
                selectItems.classList.add('select-hide');
                
                // Switch language
                if (window.languageManager) {
                    window.languageManager.switchLanguage(value);
                }
            });
        });
    });
    
    // Close all dropdowns when clicking outside
    document.addEventListener('click', closeAllSelects);
    
    function closeAllSelects(exceptThis) {
        const selectItems = document.querySelectorAll('.select-items');
        const selectSelected = document.querySelectorAll('.select-selected');
        
        selectItems.forEach(selectItem => {
            if (exceptThis && exceptThis.nextElementSibling === selectItem) {
                return;
            }
            selectItem.classList.add('select-hide');
        });
    }
});
